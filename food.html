<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Food Up</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* ==== CSS KAMU (DIRAPIKAN) ==== */
.font-teko { font-family: 'Teko', sans-serif; }

.item-bg {
  background-size: cover;
  background-position: top left;
  transition: transform .24s ease-in-out;
  height: 100%;
}
.item:hover .item-bg {
  transform: scale(1.24) translate(10%,12%);
}

.item:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px rgba(212,175,55,.8);
}

body {
  background: url("https://i.imgur.com/f9OcU99.jpeg") no-repeat center/cover fixed;
}
body::before {
  content:"";
  position:fixed;
  inset:0;
  background:rgba(8,2,12,.8);
  pointer-events:none;
}
</style>
</head>

<body class="text-white">
<div class="container mx-auto p-4 relative z-10">

<input id="searchBar" oninput="searchItems()" placeholder="Search..."
class="w-full mb-4 p-2 bg-gray-800 border border-amber-500">

<label class="flex gap-2 mb-4">
<input type="checkbox" id="show-favorites">
<span>Start w/ favorites</span>
</label>

<div id="item-grid"
class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>

</div>

<script>
/* ==== UTIL ==== */
function escapeString(str){
  return str.toLowerCase().replace(/[^a-z0-9]+/g,'-');
}
function getUniqueKey(item){
  return `${escapeString(item.title)}-${escapeString(item.group)}-${escapeString(item.rank)}`;
}
function normalizeFoodIds(item){
  if(item.foodIds) return item.foodIds;
  if(item.foodId) return [item.foodId];
  return [];
}

/* ==== FAVORITE ==== */
function toggleFavorite(id,e){
  const key=`favorite-${id}`;
  const val=localStorage.getItem(key)==='true';
  localStorage.setItem(key,!val);
  renderItems();
}

/* ==== RENDER ==== */
function getFoodElements(item){
  return normalizeFoodIds(item).map(id=>{
    const f=foodItems.find(x=>x.id===id);
    return `
    <div class="item-food text-center">
      <img src="${f.image}" class="w-20 mx-auto">
      <p>${f.name}</p>
    </div>`;
  }).join('');
}

function createItemCard(item,id){
return `
<div class="item bg-gray-800 p-4 relative">
<div class="h-48 relative overflow-hidden">
  <div class="item-bg" style="background-image:url('${item.image}')"></div>
</div>

<h3 class="font-teko text-3xl text-amber-400">${item.raceName}</h3>
<p class="text-sm">${item.title}</p>

<div class="flex gap-2 mt-2">${getFoodElements(item)}</div>

<button onclick="toggleFavorite('${id}',event)"
class="absolute top-2 right-2">
<i class="fas fa-star ${localStorage.getItem('favorite-'+id)==='true'
?'text-amber-500':'text-gray-500'}"></i>
</button>
</div>`;
}

function renderItems(){
  const grid=document.getElementById("item-grid");
  grid.innerHTML="";
  items.forEach(item=>{
    const id=getUniqueKey(item);
    grid.insertAdjacentHTML("beforeend",createItemCard(item,id));
  });
}

/* ==== SEARCH ==== */
function searchItems(){
  const t=searchBar.value.toLowerCase();
  document.querySelectorAll("#item-grid .item").forEach(el=>{
    el.style.display=el.innerText.toLowerCase().includes(t)?"":"none";
  });
}

/* ==== INIT ==== */
renderItems();
</script>
</body>
</html>
